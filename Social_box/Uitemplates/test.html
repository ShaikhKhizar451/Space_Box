<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
</head>

<body>
  <form class="form-inline" method="post" id="formElem">
<!--    <input type="text" name="img_vd" class="form-control" id="1" placeholder="Name in which Column Number">-->
<img src="" alt="" height="500">
    <label>caption</label> <input type="text" id="caption" name="caption"><br>
    <label>likes</label> <input type="text" id="likes" name="likes"><br>
    <label>created on</label> <input type="date" id="created_on" name="created_on"><br>
    <input class="form-control" name="file" type="file" id="formFile" required>
    <div style="margin:5%; text-align: center;">
      <button type="submit" class="btn btn-primary btn-sm" id="submit">Upload CSV</button>
    </div>
  </form>
</body>
<script>
  formElem.onsubmit = async (e) => {
    e.preventDefault();
    var input = document.querySelector('input[type="file"]')
    var data = new FormData();
    // data.append('file', input.files[0]);
    // data.append('img_vd', document.getElementById('1').value);
    let response = await fetch('http://127.0.0.1:8000/create_post', {
      headers: {
        'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJraGl6YXJAZ21haWwuY29tIiwiZXhwIjoxNjcxNjU0OTc4fQ.4OuF-aFMTxY_ezSyxHnF9DjVsc-EMrt1BsBcu8NxFk8'
      },
      method: 'post',
      body: new FormData(formElem),
      // body: data,
    });

    let result = await response.json();
    console.log(result);
  }


  function submitForm() {
    var image_video = document.getElementById('image_video').value;
    var caption = document.getElementById('caption').value
    var created_on = document.getElementById('created_on').value
    console.log(image_video, caption, created_on)

    fetch("http://127.0.0.1:8000/uploadImg",
      {
        headers: {
          'Accept': 'application/json',
          'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJIYW5zQGdtYWlsLmNvbSIsImV4cCI6MTY3MTU2NjIyNX0.xZXP4FDUf-I9i35g-y7p_kxy8Sd6NYJdQRDueGMyn1M',
          'Content-Type': 'multipart/form-data'
        },
        method: "POST",
        body: JSON.stringify({ 'image_video': image_video, 'caption': caption, 'likes': 0, 'created_on': created_on })
      })
      .then(function (res) { console.log(res) })
      .catch(function (res) { console.log(res) })
  }
</script>

</html>